/* --------------------
   Case Study Questions
   --------------------*/
   

-- 1. What is the total amount each customer spent at the restaurant?

SELECT customer_id, SUM(price) AS total_expense 
FROM dannys_diner.sales
JOIN dannys_diner.menu
ON dannys_diner.sales.product_id=dannys_diner.menu.product_id
GROUP BY customer_id
ORDER BY customer_id;

-- 2. How many days has each customer visited the restaurant?

SELECT customer_id, COUNT(order_date) AS visits
FROM dannys_diner.sales
GROUP BY customer_id
ORDER BY customer_id;

-- 3. What was the first item from the menu purchased by each customer?

SELECT s.order_date, s.customer_id, m.product_name
FROM dannys_diner.sales s
JOIN dannys_diner.menu m
ON s.product_id = m.product_id
GROUP BY s.order_date, s.customer_id, m.product_name
ORDER BY s.order_date;
